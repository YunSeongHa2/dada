<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>shape memory game</title>
  <style>
    body { text-align: center; font-family: 'Comic Sans MS', 'Comic Sans', cursive; background: #ffffff; padding: 20px; }
    #shapeContainer {
      display: flex;
      flex-wrap: wrap;          /* ì—¬ëŸ¬ ì¤„ë¡œ ë‚˜ëˆ ì„œ ë°°ì¹˜ */
      justify-content: center;  /* ì¤„ ì•ˆì—ì„œ ê°€ë¡œ ì¤‘ì•™ ì •ë ¬ */
      gap: 20px;
      margin: 30px auto 0;      /* ìœ„ìª½ ì—¬ë°± + ì¢Œìš° ìë™ ì¤‘ì•™ */
      max-width: 500px;         /* í•œ ì¤„ ìµœëŒ€ í­, í•„ìš”ì‹œ ì¡°ì • */
    }
    .shape {
      width: 80px; height: 80px; cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      font-size: 40px; border: 2px solid #333; border-radius: 10px;
      user-select: none;
      transition: transform 0.2s;
    }
    .shape:hover { transform: scale(1.1); }
    #startButton { margin-top: 20px; padding: 10px 20px; font-size: 18px; cursor: pointer;
      border: none; border-radius: 8px; background: linear-gradient(135deg,#6a11cb,#2575fc); color:white;}
    #result { margin-top: 20px; font-size: 24px; font-weight: bold; }
  </style>
</head>
<body>

<h1 id="homeButton">ğŸ§  shape memory game</h1>
<p>Remember the shape patterns that appear briefly on the screen and click them in order!</p>
<div id="shapeContainer"></div>
<button id="startButton">Start</button>
<div id="result"></div>

<script>
  document.getElementById('homeButton').addEventListener('click', function() {
    window.location.href = '/main';
  });

  // const shapes = ["â–²","â– ","â—","â—†","â˜…","â˜€","â˜‚","â˜ƒ","âœ¿","âœˆ"]; // 10ê°œ ë„í˜•
  // const shapes = ["â–²","â– ","â—","â—†","â˜…","â˜€","â˜‚","â˜ƒ","âœ¿","âœˆ","â™«","â˜¯","âš¡","â¤","â˜˜"];
  const shapes = [
    "â–²","â– ","â—","â—†","â˜…","â˜€","â˜‚","â˜ƒ","âœ¿","âœˆ",
    "â™«","â˜¯","âš¡","â¤","â˜˜","â˜","â˜‚","â˜ ","âœª","âœˆ"
  ];
  let pattern = [];
  let playerInput = [];
  let clickable = false;

  const container = document.getElementById('shapeContainer');
  const resultDiv = document.getElementById('result');

  // í™”ë©´ì— ë„í˜• 5ê°œ í‘œì‹œ
  function displayShapes(showPattern=false) {
    container.innerHTML = '';
    shapes.forEach((shape, idx) => {
      const div = document.createElement('div');
      div.classList.add('shape');
      div.textContent = shape;

      div.style.background = showPattern && pattern.includes(idx) ? '#ffeb3b' : '#ffffff';

      div.addEventListener('click', () => handleClick(idx));
      container.appendChild(div);
    });
  }

  // íŒ¨í„´ ìƒì„±
  function generatePattern() {
    pattern = [];
    while(pattern.length < 5){
      const idx = Math.floor(Math.random() * shapes.length);
      if(!pattern.includes(idx)) pattern.push(idx);
    }
  }

  // í´ë¦­ ì²˜ë¦¬
  function handleClick(idx){
    if(!clickable) return;
    playerInput.push(idx);

    const divs = document.querySelectorAll('.shape');
    const clickedDiv = divs[idx];

    // í´ë¦­í•œ ë„í˜• íš¨ê³¼: ì´ˆë¡(ì •ë‹µ) / ë¹¨ê°•(ì˜¤ë‹µ)
    if(playerInput[playerInput.length-1] === pattern[playerInput.length-1]){
      clickedDiv.style.background = '#8bc34a'; // ì´ˆë¡
    } else {
      clickedDiv.style.background = '#f44336'; // ë¹¨ê°•
    }

    // 0.5ì´ˆ í›„ ì›ë˜ ìƒ‰ìœ¼ë¡œ ëŒì•„ê°€ê¸°
    setTimeout(() => {
      clickedDiv.style.background = '#ffffff';
    }, 500);

    // ìˆœì„œ í‹€ë¦¬ë©´ ì‹¤íŒ¨
    if(playerInput[playerInput.length-1] !== pattern[playerInput.length-1]){
      clickable = false;
      resultDiv.textContent = "âŒ fail! Please try again.";
      return;
    }

    // ëª¨ë‘ ë§íˆë©´ ì„±ê³µ
    if(playerInput.length === pattern.length){
      clickable = false;
      resultDiv.textContent = "ğŸ‰ success! You remembered!";
    }
  }

  // ê²Œì„ ì‹œì‘
  document.getElementById('startButton').addEventListener('click', () => {
    playerInput = [];
    resultDiv.textContent = '';
    generatePattern();
    clickable = false;
    container.innerHTML = '';

    let i = 0;

    function highlightNext() {
      container.innerHTML = '';
      shapes.forEach((shape, idx) => {
        const div = document.createElement('div');
        div.classList.add('shape');
        div.textContent = shape;
        if(idx === pattern[i]) div.style.background = '#ffeb3b'; // í˜„ì¬ ìˆœì„œ ê°•ì¡°
        else div.style.background = '#ffffff';
        div.addEventListener('click', () => handleClick(idx));
        container.appendChild(div);
      });

      i++;
      if(i < pattern.length) {
        setTimeout(highlightNext, 700); // ë‹¤ìŒ ë„í˜• ê°•ì¡°
      } else {
        // ë§ˆì§€ë§‰ ê°•ì¡° í›„ 1ì´ˆ ë’¤ ì „ì²´ í°ìƒ‰ìœ¼ë¡œ
        setTimeout(() => {
          displayShapes(false);
          clickable = true;
        }, 700);
      }
    }

    highlightNext(); // ì‹œì‘
  });

</script>
</body>
</html>
